<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF & Document Tools - SmartGenEduX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .drop-zone {
            transition: border-color 0.2s, background-color 0.2s;
        }
        .drop-zone:hover, .drop-zone.drag-over {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .tool-card {
            transition: transform 0.2s, box-shadow 0.2s;
            border-radius: 0.75rem;
        }
        .tool-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .file-upload-hidden {
            opacity: 0;
            width: 0.1px;
            height: 0.1px;
            position: absolute;
            overflow: hidden;
            z-index: -1;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <!-- Notification Area -->
        <div id="notification-area" class="fixed top-4 right-4 z-50"></div>

        <!-- Header -->
        <div class="bg-white rounded-lg shadow-xl p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <!-- Placeholder for image, using icon for compliance -->
                    <div class="w-12 h-12 mr-4 bg-gray-200 rounded-lg flex items-center justify-center">
                        <i class="fas fa-file-invoice text-2xl text-gray-700"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">PDF & Document Tools</h1>
                        <p class="text-gray-600">Convert, compile, and manage documents with advanced processing</p>
                    </div>
                </div>
                <button onclick="window.close()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition duration-150">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Dashboard
                </button>
            </div>
        </div>

        <!-- Tool Categories -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
            
            <!-- PDF to Word -->
            <div class="bg-white tool-card shadow-md p-6">
                <div class="text-center mb-4">
                    <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i class="fas fa-file-pdf text-2xl text-red-600"></i>
                    </div>
                    <h3 class="text-lg font-bold">PDF to Word</h3>
                    <p class="text-gray-600 text-sm">Convert PDF files to editable Word documents</p>
                </div>
                <div id="dropZonePdfToWord" class="drop-zone border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer">
                    <input type="file" id="pdfToWord" accept=".pdf" class="file-upload-hidden" onchange="handleFileSelection('pdfToWord', this)">
                    <label for="pdfToWord">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600"><span id="fileNamePdfToWord">Drop PDF file or click to upload</span></p>
                    </label>
                </div>
                <button onclick="convertDocument('pdfToWord', 'Word')" class="w-full mt-4 bg-red-600 text-white py-2 rounded hover:bg-red-700 transition duration-150" id="btnPdfToWord">
                    <i class="fas fa-exchange-alt mr-2"></i>Convert to Word
                </button>
            </div>

            <!-- Word to PDF -->
            <div class="bg-white tool-card shadow-md p-6">
                <div class="text-center mb-4">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i class="fas fa-file-word text-2xl text-blue-600"></i>
                    </div>
                    <h3 class="text-lg font-bold">Word to PDF</h3>
                    <p class="text-gray-600 text-sm">Convert Word documents to PDF format</p>
                </div>
                <div id="dropZoneWordToPdf" class="drop-zone border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer">
                    <input type="file" id="wordToPdf" accept=".doc,.docx" class="file-upload-hidden" onchange="handleFileSelection('wordToPdf', this)">
                    <label for="wordToPdf">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600"><span id="fileNameWordToPdf">Drop Word file or click to upload</span></p>
                    </label>
                </div>
                <button onclick="convertDocument('wordToPdf', 'PDF')" class="w-full mt-4 bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition duration-150" id="btnWordToPdf">
                    <i class="fas fa-exchange-alt mr-2"></i>Convert to PDF
                </button>
            </div>

            <!-- Document Compiler (Merge) -->
            <div class="bg-white tool-card shadow-md p-6">
                <div class="text-center mb-4">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                        <i class="fas fa-layer-group text-2xl text-green-600"></i>
                    </div>
                    <h3 class="text-lg font-bold">Document Compiler</h3>
                    <p class="text-gray-600 text-sm">Merge multiple documents into one</p>
                </div>
                <div id="dropZoneMultipleFiles" class="drop-zone border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer">
                    <input type="file" id="multipleFiles" multiple accept=".pdf,.doc,.docx" class="file-upload-hidden" onchange="handleFileSelection('multipleFiles', this)">
                    <label for="multipleFiles">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600"><span id="fileNameMultipleFiles">Select multiple files to compile</span></p>
                    </label>
                </div>
                <button onclick="compileDocuments()" class="w-full mt-4 bg-green-600 text-white py-2 rounded hover:bg-green-700 transition duration-150" id="btnCompileDocuments">
                    <i class="fas fa-compress mr-2"></i>Compile Documents
                </button>
            </div>
        </div>

        <!-- Bulk Operations -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">Bulk Operations</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-3">Batch Conversion</h3>
                    <div id="dropZoneBatchFiles" class="drop-zone border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer">
                        <input type="file" id="batchFiles" multiple accept=".pdf,.doc,.docx" class="file-upload-hidden" onchange="handleFileSelection('batchFiles', this)">
                        <label for="batchFiles">
                            <i class="fas fa-files-medical text-4xl text-gray-400 mb-3"></i>
                            <p class="text-gray-600 mb-2"><span id="fileNameBatchFiles">Upload multiple files for batch processing</span></p>
                            <p class="text-sm text-gray-500">Supports PDF, DOC, DOCX formats</p>
                        </label>
                    </div>
                    <div class="mt-4 flex space-x-2">
                        <button onclick="batchConvert('PDF')" class="flex-1 bg-purple-600 text-white py-2 rounded hover:bg-purple-700 transition duration-150" id="btnBatchToPdf">
                            Convert All to PDF
                        </button>
                        <button onclick="batchConvert('Word')" class="flex-1 bg-orange-600 text-white py-2 rounded hover:bg-orange-700 transition duration-150" id="btnBatchToWord">
                            Convert All to Word
                        </button>
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-semibold mb-3">Document Templates</h3>
                    <div class="space-y-2">
                        <button onclick="generateTemplate('Report')" class="w-full bg-gray-100 hover:bg-gray-200 p-3 rounded text-left transition duration-150">
                            <i class="fas fa-file-alt mr-2 text-blue-600"></i>
                            <span class="font-medium">Student Report Template</span>
                        </button>
                        <button onclick="generateTemplate('Certificate')" class="w-full bg-gray-100 hover:bg-gray-200 p-3 rounded text-left transition duration-150">
                            <i class="fas fa-certificate mr-2 text-yellow-600"></i>
                            <span class="font-medium">Certificate Template</span>
                        </button>
                        <button onclick="generateTemplate('Letter')" class="w-full bg-gray-100 hover:bg-gray-200 p-3 rounded text-left transition duration-150">
                            <i class="fas fa-envelope mr-2 text-green-600"></i>
                            <span class="font-medium">Official Letter Template</span>
                        </button>
                        <button onclick="generateTemplate('Invoice')" class="w-full bg-gray-100 hover:bg-gray-200 p-3 rounded text-left transition duration-150">
                            <i class="fas fa-receipt mr-2 text-purple-600"></i>
                            <span class="font-medium">Fee Invoice Template</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Conversions (History) -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold">Recent Operations History</h2>
                <button onclick="clearHistory()" class="text-red-600 hover:text-red-800 text-sm transition duration-150">
                    <i class="fas fa-trash-alt mr-1"></i>Clear History
                </button>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full text-sm">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-2 text-left">File Name</th>
                            <th class="px-4 py-2 text-left">Operation</th>
                            <th class="px-4 py-2 text-left">Status</th>
                            <th class="px-4 py-2 text-left">Date</th>
                            <th class="px-4 py-2 text-left">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- History will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let fileReferences = {}; // Stores files selected for conversion/compilation

        // Utility function to display messages
        function showMessage(message, type) {
            const colors = { 'success': 'bg-green-600', 'error': 'bg-red-600', 'info': 'bg-blue-600', 'warning': 'bg-yellow-600' };
            const icons = { 'success': 'fas fa-check-circle', 'error': 'fas fa-exclamation-triangle', 'info': 'fas fa-info-circle', 'warning': 'fas fa-bell' };
            
            const area = document.getElementById('notification-area');
            const messageDiv = document.createElement('div');
            messageDiv.className = `p-3 mb-2 flex items-center ${colors[type]} text-white rounded-lg shadow-lg transition-all duration-300 transform translate-x-0`;
            messageDiv.innerHTML = `<i class="${icons[type]} mr-3"></i><span>${message}</span>`;
            area.appendChild(messageDiv);
            
            setTimeout(() => { messageDiv.remove(); }, 5000);
        }

        // --- Core File Handling ---
        
        function handleFileSelection(id, input) {
            fileReferences[id] = input.files;
            const fileNameSpan = document.getElementById(`fileName${id.charAt(0).toUpperCase() + id.slice(1)}`);
            
            if (input.files.length === 1) {
                fileNameSpan.innerHTML = `<span class="text-blue-600 font-medium">${input.files[0].name}</span> selected. Click Convert.`;
                showMessage(`File "${input.files[0].name}" selected.`, 'info');
            } else if (input.files.length > 1) {
                fileNameSpan.innerHTML = `<span class="text-blue-600 font-medium">${input.files.length} files</span> ready for batch.`;
                showMessage(`${input.files.length} files selected.`, 'info');
            }
        }
        
        // --- History Management ---

        function addHistoryEntry(fileName, operation, status) {
            const body = document.getElementById('historyTableBody');
            const row = body.insertRow(0); // Insert at top
            
            let statusClass = '';
            let statusText = '';
            let actionHtml = '';

            if (status === 'Completed') {
                statusClass = 'bg-green-100 text-green-800';
                statusText = 'Completed';
                actionHtml = `<button class="text-blue-600 hover:text-blue-800 mr-2" title="Download"><i class="fas fa-download"></i></button>`;
            } else if (status === 'Processing') {
                statusClass = 'bg-yellow-100 text-yellow-800';
                statusText = 'Processing';
                actionHtml = `<button class="text-gray-400" title="Processing" disabled><i class="fas fa-spinner fa-spin"></i></button>`;
            }

            row.className = 'border-t';
            row.innerHTML = `
                <td class="px-4 py-2">${fileName}</td>
                <td class="px-4 py-2">${operation}</td>
                <td class="px-4 py-2"><span class="px-2 py-1 rounded text-xs ${statusClass}">${statusText}</span></td>
                <td class="px-4 py-2">${new Date().toLocaleString()}</td>
                <td class="px-4 py-2">${actionHtml}
                    <button class="text-red-600 hover:text-red-800 ml-2 delete-history-btn" title="Delete"><i class="fas fa-trash-alt"></i></button>
                </td>
            `;

            // Attach delete listener (Simulated)
            row.querySelector('.delete-history-btn').addEventListener('click', (e) => {
                if (confirm(`Are you sure you want to delete the history for ${fileName}?`)) {
                    e.target.closest('tr').remove();
                    showMessage('History entry deleted.', 'info');
                }
            });
        }
        
        function clearHistory() {
            if (confirm('Are you sure you want to clear ALL conversion history?')) {
                document.getElementById('historyTableBody').innerHTML = '';
                showMessage('Conversion history cleared.', 'success');
            }
        }

        // --- Conversion Logic ---

        async function convertDocument(inputId, targetFormat) {
            const files = fileReferences[inputId];
            if (!files || files.length === 0) {
                showMessage(`Please select a file to convert to ${targetFormat}`, 'error');
                return;
            }
            
            const fileName = files[0].name;
            const btn = document.getElementById(`btn${inputId.charAt(0).toUpperCase() + inputId.slice(1)}`);
            const originalText = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Converting...';
            btn.disabled = true;
            
            addHistoryEntry(fileName, `${fileName.split('.').pop().toUpperCase()} → ${targetFormat}`, 'Processing');

            await new Promise(resolve => setTimeout(resolve, 3000)); 
            
            btn.innerHTML = originalText;
            btn.disabled = false;
            
            showMessage(`Conversion of "${fileName}" completed successfully!`, 'success');
            
            // Update history status (simulated update)
            const body = document.getElementById('historyTableBody');
            body.rows[0].querySelector('.px-2.py-1').className = 'px-2 py-1 rounded text-xs bg-green-100 text-green-800';
            body.rows[0].querySelector('.px-2.py-1').textContent = 'Completed';
            
            // Reset input and file reference
            document.getElementById(inputId).value = null;
            fileReferences[inputId] = null;
            document.getElementById(`fileName${inputId.charAt(0).toUpperCase() + inputId.slice(1)}`).textContent = `Drop ${targetFormat === 'Word' ? 'PDF' : 'Word'} file or click to upload`;
        }

        async function compileDocuments() {
            const files = fileReferences['multipleFiles'];
            if (!files || files.length < 2) {
                showMessage('Select at least two files to compile.', 'error');
                return;
            }
            
            const btn = document.getElementById('btnCompileDocuments');
            const originalText = btn.innerHTML;
            const count = files.length;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Compiling...';
            btn.disabled = true;
            
            addHistoryEntry(`Compiled_Document_${count}x.pdf`, `Merge ${count} Files`, 'Processing');

            await new Promise(resolve => setTimeout(resolve, 4000));
            
            btn.innerHTML = originalText;
            btn.disabled = false;
            
            showMessage(`Compilation of ${count} documents completed successfully!`, 'success');

            // Simulate history update
            const body = document.getElementById('historyTableBody');
            body.rows[0].querySelector('.px-2.py-1').className = 'px-2 py-1 rounded text-xs bg-green-100 text-green-800';
            body.rows[0].querySelector('.px-2.py-1').textContent = 'Completed';
            
            document.getElementById('multipleFiles').value = null;
            fileReferences['multipleFiles'] = null;
            document.getElementById('fileNameMultipleFiles').textContent = `Select multiple files to compile`;
        }

        // --- Batch Conversion Logic ---

        async function batchConvert(targetFormat) {
            const files = fileReferences['batchFiles'];
            if (!files || files.length === 0) {
                showMessage('Please upload files for batch processing.', 'error');
                return;
            }
            
            const btnId = targetFormat === 'PDF' ? 'btnBatchToPdf' : 'btnBatchToWord';
            const btn = document.getElementById(btnId);
            const originalText = btn.innerHTML;
            const count = files.length;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
            btn.disabled = true;
            
            addHistoryEntry(`Batch_Convert_${count}x.zip`, `Batch → ${targetFormat}`, 'Processing');

            await new Promise(resolve => setTimeout(resolve, 5000)); 
            
            btn.innerHTML = originalText;
            btn.disabled = false;

            showMessage(`Batch conversion of ${count} files to ${targetFormat} completed!`, 'success');

            // Simulate history update
            const body = document.getElementById('historyTableBody');
            body.rows[0].querySelector('.px-2.py-1').className = 'px-2 py-1 rounded text-xs bg-green-100 text-green-800';
            body.rows[0].querySelector('.px-2.py-1').textContent = 'Completed';

            document.getElementById('batchFiles').value = null;
            fileReferences['batchFiles'] = null;
            document.getElementById('fileNameBatchFiles').textContent = `Upload multiple files for batch processing`;
        }

        // --- Template Generation Logic ---

        function generateTemplate(type) {
            showMessage(`Generating ${type} Template...`, 'info');
            
            setTimeout(() => {
                showMessage(`${type} Template generated and downloaded!`, 'success');
                addHistoryEntry(`${type}_Template.docx`, 'Template Generation', 'Completed');
            }, 2000);
        }

        // --- Initialize History with Mock Data ---
        document.addEventListener('DOMContentLoaded', () => {
            // Add initial mock entries for realism
            addHistoryEntry('Batch_Certificates.zip', 'Batch Compile', 'Processing');
            addHistoryEntry('Fee_Structure_2025.docx', 'Word → PDF', 'Completed');
            addHistoryEntry('Student_Report_Class5.pdf', 'PDF → Word', 'Completed');

            // Setup Drag and Drop functionality
            ['dropZonePdfToWord', 'dropZoneWordToPdf', 'dropZoneMultipleFiles', 'dropZoneBatchFiles'].forEach(id => {
                const dropZone = document.getElementById(id);
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('drag-over');
                });
                dropZone.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                });
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('drag-over');
                    const fileInput = dropZone.querySelector('input[type="file"]');
                    if (e.dataTransfer.files.length) {
                        fileInput.files = e.dataTransfer.files;
                        handleFileSelection(fileInput.id, fileInput);
                    }
                });
            });
        });

    </script>
</body>
</html>
